name: packer run

on:
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - run: sudo apt install wireguard
      - env:
          PROXMOX_URL: ${{ vars.PROXMOX_URL }}
          PROXMOX_USER: ${{ secrets.PROXMOX_API_USER }}
          PROXMOX_PASSWORD: ${{ secrets.PROXMOX_API_PASSWORD }}
        run: | 
          cd scripts
          pip install -r requirements.txt
          chown +x pmx_delete_vm.py && pmx_delete_vm.py -vm_id 102
